<%# app/views/therapy_plans/_form.html.erb %>

<%# This partial provides the common form fields for creating and editing therapy plans. %>
<%# It assumes the form object `f` is passed to it, along with `@internal_client_profile`. %>

<%# Display validation errors if any %>
<% if f.object.errors.any? %>
  <div class="notification is-danger">
    <p><strong>Please correct the following errors:</strong></p>
    <ul>
      <% f.object.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
    </ul>
  </div>
<% end %>

<%# Diagnosis text area %>
<div class="field">
  <%= f.label :diagnosis, class: "label" %>
  <div class="control">
    <%= f.text_area :diagnosis, rows: 3, class: "textarea" %>
  </div>
</div>

<%# Short Term Goals text area %>
<div class="field">
  <%= f.label :short_term_goals, class: "label" %>
  <div class="control">
    <%= f.text_area :short_term_goals, rows: 3, class: "textarea" %>
  </div>
</div>

<%# Long Term Goals text area %>
<div class="field">
  <%= f.label :long_term_goals, class: "label" %>
  <div class="control">
    <%= f.text_area :long_term_goals, rows: 3, class: "textarea" %>
  </div>
</div>

<%# Intervention Details text area %>
<div class="field">
  <%= f.label :intervention_details, class: "label" %>
  <div class="control">
    <%= f.text_area :intervention_details, rows: 3, class: "textarea" %>
  </div>
</div>

<%# Frequency text field %>
<div class="field">
  <%= f.label :frequency, class: "label" %>
  <div class="control">
    <%= f.text_field :frequency, class: "input" %>
  </div>
</div>

<%# Duration Weeks number field %>
<div class="field">
  <%= f.label :duration_weeks, class: "label" %>
  <div class="control">
    <%= f.number_field :duration_weeks, class: "input" %>
  </div>
</div>

<%# Progress Metrics text area %>
<div class="field">
  <%= f.label :progress_metrics, class: "label" %>
  <div class="control">
    <%= f.text_area :progress_metrics, rows: 3, class: "textarea" %>
  </div>
</div>

<%# Start Date field %>
<div class="field">
  <%= f.label :start_date, class: "label" %>
  <div class="control">
    <%= f.date_field :start_date, class: "input" %>
  </div>
</div>

<%# End Date field %>
<div class="field">
  <%= f.label :end_date, class: "label" %>
  <div class="control">
    <%= f.date_field :end_date, class: "input" %>
  </div>
</div>

<%# Form submission buttons %>
<div class="field is-grouped mt-4">
  <div class="control">
    <%= f.submit "Save Therapy Plan", class: "button is-primary" %>
  </div>
  <div class="control">
    <%# The cancel link should point back to the therapy plan's show page %>
    <%= link_to "Cancel", [@internal_client_profile, f.object], class: "button is-light" %>
  </div>
</div>
