<!-- 
  Redesigned Psychologist Profile Page
  New Color Scheme: Lavender and Dark Teal/Green
  Layout: Two-column on desktop, single-column on mobile
  Goal: Professional, welcoming, and calming aesthetic
-->

<style>
/* FONT IMPORTS */
@import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css');
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

/* COLOR & DESIGN TOKENS */
:root {
    --primary-purple: #755589; /* A deep amethyst purple */
    --primary-purple-light: #ECE5F0;
    --secondary-teal-dark: #2F4D4A; /* A very deep, calming teal */
    --accent-peach: #E99D8B;
    --accent-peach-dark: #D48472;
    --text-primary: #2F4D4A; /* Deep teal */
    --text-secondary: #6A7978;
    --background-main: #F8FBFB; /* A very light, cool off-white */
    --background-card: #FFFFFF;
    --border-color: #DDE5E5;
    --success: #3E9C75;
    --success-bg: #E6F5EE;
    --warning-bg: #FEF7EC;

    --radius-sm: 0.5rem;
    --radius-md: 0.75rem;
    --radius-lg: 1rem;
    --shadow-soft: 0 4px 12px rgba(47, 77, 74, 0.08);
    --shadow-medium: 0 8px 24px rgba(47, 77, 74, 0.1);
}

/* BASE STYLES */
.psychologist-profile-body {
    font-family: 'Inter', sans-serif;
    background-color: var(--background-main);
    color: var(--text-primary);
    line-height: 1.6;
}

/* LAYOUT CONTAINER */
.profile-container {
    display: grid;
    grid-template-columns: 320px 1fr;
    gap: 2.5rem;
    max-width: 1200px;
    margin: 3rem auto;
    padding: 0 1.5rem;
}

/* SIDEBAR (LEFT COLUMN) */
.profile-sidebar {
    position: sticky;
    top: 2rem;
    align-self: start;
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.sidebar-card {
    background-color: var(--background-card);
    border-radius: var(--radius-lg);
    border: 1px solid var(--border-color);
    padding: 2rem;
    text-align: center;
    box-shadow: var(--shadow-soft);
}

.profile-avatar {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    object-fit: cover;
    border: 4px solid var(--background-card);
    box-shadow: 0 5px 15px rgba(47, 72, 88, 0.15);
    margin: -5rem auto 1rem;
}

.profile-name {
    font-size: 1.75rem;
    font-weight: 700;
    margin: 0;
}

.name-badges-container {
    display: flex;
    justify-content: center;
    gap: 0.5rem;
    margin-top: 0.5rem;
    flex-wrap: wrap;
}

.name-badge {
    display: inline-flex;
    align-items: center;
    padding: 0.25rem 0.6rem;
    border-radius: 99px;
    font-size: 0.75rem;
    font-weight: 500;
    gap: 0.3rem;
}

.name-badge.is-doctor {
    background-color: var(--primary-purple-light);
    color: var(--primary-purple);
}

.name-badge.certified {
    background-color: var(--success-bg);
    color: var(--success);
}

.profile-location {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin: 0.75rem 0;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.4rem;
}
.profile-location i {
    color: var(--primary-purple);
}

.profile-experience {
    background-color: var(--primary-purple-light);
    color: var(--text-secondary);
    border-radius: var(--radius-sm);
    padding: 0.5rem 1rem;
    font-size: 0.875rem;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 1rem;
}
.profile-experience i {
    color: var(--primary-purple);
}

.availability-widget-top {
    font-size: 0.875rem;
    padding: 0.6rem 1rem;
    border-radius: var(--radius-sm);
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 500;
    border: 1px solid;
}

.availability-widget-top.available {
    background-color: var(--success-bg);
    color: var(--success);
    border-color: #CEE4DB;
}

.availability-widget-top.unavailable {
    background-color: var(--warning-bg);
    color: #D9822B;
    border-color: #F7E5C9;
}

.button-group {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin-top: 1.5rem;
}

.button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.875rem 1.5rem;
    border-radius: var(--radius-md);
    font-weight: 600;
    cursor: pointer;
    text-decoration: none;
    transition: all 0.2s ease;
    border: 2px solid transparent;
    font-size: 0.95rem;
}

.button.is-primary {
    background-color: var(--accent-peach);
    color: var(--background-card);
}
.button.is-primary:hover {
    background-color: var(--accent-peach-dark);
    transform: translateY(-2px);
    box-shadow: 0 4px 10px rgba(217, 140, 124, 0.3);
}

.button.is-secondary {
    background-color: transparent;
    color: var(--text-primary);
    border-color: var(--border-color);
}
.button.is-secondary:hover {
    background-color: var(--primary-purple-light);
    border-color: var(--primary-purple);
}

/* MAIN CONTENT (RIGHT COLUMN) */
.profile-main {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.content-card {
    background-color: var(--background-card);
    border-radius: var(--radius-lg);
    border: 1px solid var(--border-color);
    padding: 2.5rem;
    box-shadow: var(--shadow-soft);
}

.section-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 1.5rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    align-items: center;
    gap: 0.75rem;
}
.section-title i {
    color: var(--primary-purple);
    font-size: 1.2rem;
}

.section-content p, .section-content ul {
    color: var(--text-secondary);
    font-size: 1rem;
    line-height: 1.7;
}
.section-content p:last-child {
    margin-bottom: 0;
}

/* Service Card */
.service-card-new {
    border: 1px solid var(--border-color);
    border-radius: var(--radius-md);
    margin-top: 1.5rem;
    padding: 1.5rem;
    background-color: #FDFDFD;
    transition: box-shadow 0.3s ease, transform 0.3s ease;
}
.service-card-new:hover {
    transform: translateY(-3px);
    box-shadow: var(--shadow-medium);
}

.service-card-new h3 {
    font-size: 1.25rem;
    font-weight: 600;
    margin: 0 0 0.5rem 0;
}
.service-card-new h3 a {
    color: var(--text-primary);
    text-decoration: none;
}
.service-card-new h3 a:hover {
    color: var(--accent-peach-dark);
}
.service-card-new .service-description {
    font-size: 0.95rem;
    margin-bottom: 1.5rem;
    color: var(--text-secondary);
}
.service-details-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 1.25rem;
    padding-top: 1.25rem;
    border-top: 1px solid var(--border-color);
}
.service-detail-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}
.service-detail-icon {
    font-size: 1.2rem;
    color: var(--primary-purple);
    width: 25px;
    text-align: center;
}
.service-detail-label {
    font-size: 0.8rem;
    color: var(--text-secondary);
}
.service-detail-value {
    font-size: 0.95rem;
    font-weight: 600;
}
.service-actions {
    margin-top: 1.5rem;
    display: flex;
    justify-content: flex-end;
}
.service-actions .button {
    padding: 0.75rem 1.25rem;
    font-size: 0.9rem;
}

/* Education Section */
.education-list {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}
.education-item {
    display: flex;
    align-items: flex-start;
    gap: 1.2rem;
}
.education-icon-wrapper {
    background-color: var(--primary-purple-light);
    color: var(--primary-purple);
    border-radius: 50%;
    width: 40px;
    height: 40px;
    flex-shrink: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
}
.education-details h3 {
    font-size: 1.1rem;
    font-weight: 600;
    margin: 0 0 0.25rem 0;
}
.education-details p {
    margin: 0;
    font-size: 0.9rem;
    color: var(--text-secondary);
}

/* Contact / Video Toggle Buttons */
.toggle-button {
    width: 100%;
    text-align: center;
    background: var(--primary-purple-light);
    border: 1px solid var(--border-color);
    padding: 0.875rem;
    border-radius: var(--radius-md);
    cursor: pointer;
    color: var(--text-primary);
    font-weight: 500;
    transition: all 0.3s ease;
    margin-top: 1.5rem;
}
.toggle-button:hover {
    border-color: var(--primary-purple);
    background-color: #EFEBF3;
}
.toggle-button i {
    transition: transform 0.3s ease;
}
.toggle-button[aria-expanded="true"] i {
    transform: rotate(180deg);
}

.collapsible-content {
    margin-top: 1.5rem;
    display: none;
    flex-direction: column;
    gap: 0.75rem;
}

.contact-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 1rem;
    background-color: var(--background-main);
    border-radius: var(--radius-sm);
    border: 1px solid var(--border-color);
}
.contact-info {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: 0.9rem;
    font-weight: 500;
}
.contact-info i {
    width: 20px;
    text-align: center;
    font-size: 1.1rem;
    color: var(--primary-purple);
}
.contact-item[data-method="telegram"] .contact-info i { color: #0088CC; }
.contact-item[data-method="whatsapp"] .contact-info i { color: #25D366; }

.contact-actions {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}
.contact-input {
    border: none;
    background: none;
    color: var(--text-secondary);
    font-size: 0.9rem;
    text-align: right;
}
.copy-button, .contact-link {
    color: var(--text-secondary);
    background: none;
    border: none;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: 50%;
    width: 32px;
    height: 32px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}
.copy-button:hover, .contact-link:hover {
    color: var(--accent-peach-dark);
    background-color: var(--primary-purple-light);
}

.video-wrapper {
    position: relative;
    padding-bottom: 56.25%;
    height: 0;
    border-radius: var(--radius-md);
    overflow: hidden;
}
.video-wrapper iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

/* UTILITIES */
.mr-2 { margin-right: 0.5rem; }

/* RESPONSIVE DESIGN */
@media (max-width: 992px) {
    .profile-container {
    grid-template-columns: 280px 1fr;
    gap: 1.5rem;
    }
    .profile-avatar {
    width: 120px;
    height: 120px;
    margin-top: -4rem;
    }
    .profile-name {
    font-size: 1.5rem;
    }
}

@media (max-width: 768px) {
    .psychologist-profile-body {
    background-color: var(--background-card);
    }
    .profile-container {
    grid-template-columns: 1fr;
    margin: 0;
    padding: 0;
    gap: 0;
    }
    .profile-sidebar {
    position: static;
    border-radius: 0;
    }
    .sidebar-card {
    border-radius: 0;
    box-shadow: none;
    border: none;
    border-bottom: 1px solid var(--border-color);
    padding: 1.5rem 1rem;
    }
    .profile-avatar {
    width: 120px;
    height: 120px;
    margin-top: 0;
    }
    .content-card {
    border-radius: 0;
    box-shadow: none;
    border: none;
    border-bottom: 1px solid var(--border-color);
    padding: 1.5rem 1rem;
    }
    .profile-main {
    gap: 0;
    }
}
</style>

<div class="psychologist-profile-body">
<div class="profile-container">
    <aside class="profile-sidebar">
        <div class="sidebar-card">
            <% if @psychologist_profile.profile_img.attached? %>
                <%= image_tag url_for(@psychologist_profile.profile_img.variant(resize_to_limit: [200, 200])), class: "profile-avatar" %>
            <% else %>
                <img src="https://placehold.co/200x200/A09ABC/FFFFFF?text=Dr" alt="Default Profile" class="profile-avatar">
            <% end %>
            
            <h1 class="profile-name"><%= "#{@psychologist_profile.first_name} #{@psychologist_profile.last_name}" %></h1>
            
            <div class="name-badges-container">
                <% if @psychologist_profile.is_doctor %>
                    <span class="name-badge is-doctor"><i class="fas fa-user-md"></i><%= t('psychologist_profiles.show.doctor') %></span>
                <% end %>
                <% if @psychologist_profile.is_degree_boolean %>
                    <span class="name-badge certified"><i class="fas fa-certificate"></i><%= t('psychologist_profiles.show.certified') %></span>
                <% end %>
            </div>
            
            <p class="profile-location">
                <% if @psychologist_profile.country.present? %>
                    <i class="fas fa-map-marker-alt"></i>
                    <span>
                        <% if @psychologist_profile.city.present? %>
                            <%= t("cities.#{@psychologist_profile.city.downcase.gsub(' ', '_').gsub('-', '_')}", default: @psychologist_profile.city) %>,
                        <% end %>
                        <%= t("countries.#{@psychologist_profile.country.downcase.gsub(' ', '_').gsub('-', '_')}", default: @psychologist_profile.country) %>
                    </span>
                <% end %>
            </p>

            <% if @psychologist_profile.years_of_experience.present? %>
                <div class="profile-experience">
                    <i class="fas fa-briefcase"></i>
                    <span><%= t('psychologist_profiles.show.years_experience', count: @psychologist_profile.years_of_experience) %></span>
                </div>
            <% end %>
        </div>
        
        <div class="sidebar-card">
            <% if @next_available_slot %>
                <div class="availability-widget-top available">
                    <i class="fas fa-calendar-check"></i>
                    <span>Next slot: <%= l(@next_available_slot, format: "%a, %b %-d") %></span>
                </div>
            <% else %>
                <div class="availability-widget-top unavailable">
                    <i class="fas fa-calendar-times"></i>
                    <span>No availability</span>
                </div>
            <% end %>

            <%# ---- Main CTA Buttons ---- %>
            <% primary_contact_method = @psychologist_profile.primary_contact_method %>
            <% contact_keys = { email: 'fas fa-envelope', telegram: 'fab fa-telegram', whatsapp: 'fab fa-whatsapp', primary_phone: 'fas fa-phone' } %>
            <% contact_link = case primary_contact_method
                                  when 'email' then "mailto:#{@psychologist_profile.user.email}"
                                  when 'telegram' then "https://t.me/#{@psychologist_profile.telegram}"
                                  when 'whatsapp' then "https://wa.me/#{@psychologist_profile.whatsapp}"
                                  when 'primary_phone' then "tel:#{@psychologist_profile.contact_phone}"
                                  else nil
                              end %>
            <div class="button-group">
                <% if @psychologist_profile.featured_service.present? %>
                    <%= link_to select_service_path(psychologist_id: @psychologist_profile.id), class: "button is-primary" do %>
                        <i class="fas fa-calendar-check mr-2"></i>
                        <span><%= t('psychologist_profiles.show.book_a_session') %></span>
                    <% end %>
                <% end %>
                <% if contact_link %>
                    <a href="<%= contact_link %>" class="button is-secondary">
                        <i class="<%= contact_keys[primary_contact_method.to_sym] %> mr-2"></i>
                        <span><%= t('psychologist_profiles.show.contact_me') %></span>
                    </a>
                <% end %>
            </div>
        </div>
    </aside>

    <main class="profile-main">
        <div class="content-card">
            <h2 class="section-title"><i class="fas fa-user-circle"></i> <%= t('psychologist_profiles.show.about_me') %></h2>
            <div class="section-content">
                <p><%= simple_format(@psychologist_profile.about_me) %></p>
            </div>
             <%# ---- Video Section (Expandable) ---- %>
            <% if @psychologist_profile.youtube_video_url.present? %>
                <% video_id = youtube_embed_url(@psychologist_profile.youtube_video_url) %>
                <% if video_id %>
                    <button class="toggle-button toggle-video" aria-expanded="false" data-show-text="Watch My Introduction" data-hide-text="Hide Video">
                        <span class="toggle-text">Watch My Introduction</span> <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="collapsible-content video-content">
                        <div class="video-wrapper">
                            <iframe src="https://www.youtube.com/embed/<%= video_id %>" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        </div>
                    </div>
                <% else %>
                    <p class="has-text-danger"><%= t('psychologist_profiles.show.invalid_youtube_link') %></p>
                <% end %>
            <% end %>
        </div>

        <% if @psychologist_profile.about_issues.present? %>
        <div class="content-card">
            <h2 class="section-title"><i class="fas fa-heartbeat"></i> <%= t('psychologist_profiles.show.areas_of_focus') %></h2>
            <div class="section-content">
                <p><%= simple_format(@psychologist_profile.about_issues) %></p>
            </div>
        </div>
        <% end %>

        <%# ---- Services Offered ---- %>
        <div class="content-card">
            <h2 class="section-title"><i class="fas fa-concierge-bell"></i> <%= t('psychologist_profiles.show.services_offered') %></h2>
            <% if @psychologist_profile.featured_service.present? %>
                <% service = @psychologist_profile.featured_service %>
                <div class="service-card-new">
                    <h3><%= link_to t("services.#{service.name}", default: service.name), service_path(service) %></h3>
                    <div class="service-description">
                        <%= simple_format(service.description) %>
                    </div>
                    
                    <div class="service-details-grid">
                        <div class="service-detail-item">
                            <i class="fas fa-hourglass-half service-detail-icon"></i>
                            <div>
                                <div class="service-detail-label">Duration</div>
                                <div class="service-detail-value"><%= t('psychologist_profiles.show.duration_minutes', count: service.duration_minutes) %></div>
                            </div>
                        </div>
                        <div class="service-detail-item">
                            <i class="fas fa-dollar-sign service-detail-icon"></i>
                            <div>
                                <div class="service-detail-label">Rate</div>
                                <div class="service-detail-value">
                                    <% if service.price == 0 %>
                                        <%= t('psychologist_profiles.show.free') %>
                                    <% else %>
                                        <% if service.currency.present? && current_currency.present? %>
                                            <% converted = service.converted_rate(current_currency) %>
                                            <%= humanized_money_with_symbol(converted) if converted %>
                                        <% end %>
                                    <% end %>
                                </div>
                            </div>
                        </div>
                        <div class="service-detail-item">
                            <i class="fas fa-<%= service.delivery_method.to_s.downcase.include?("online") ? 'laptop' : 'user-friends' %> service-detail-icon"></i>
                            <div>
                                <div class="service-detail-label">Method</div>
                                <div class="service-detail-value">
                                    <%= service.delivery_method.to_s.downcase.include?("online") ? t('psychologist_search.online') : t('psychologist_search.in_person') %>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="service-actions">
                        <%= link_to t('psychologist_profiles.show.book_this_service'), choose_time_path(psychologist_id: @psychologist_profile.id, service_id: @psychologist_profile.featured_service), class: "button is-primary" %>
                    </div>
                </div>
            <% else %>
                <p>No featured service available at this time.</p>
            <% end %>
        </div>
        
        <% if @psychologist_profile.educations.any? %>
        <div class="content-card">
            <h2 class="section-title"><i class="fas fa-graduation-cap"></i> <%= t('psychologist_profiles.show.education') %></h2>
            <div class="education-list">
                <% @psychologist_profile.educations.each do |education| %>
                    <div class="education-item">
                        <div class="education-icon-wrapper">
                            <i class="fas fa-university"></i>
                        </div>
                        <div class="education-details">
                            <h3>
                                <%= t('psychologist_profiles.show.degree_of_study',
                                    degree: t("education_degrees.#{education.degree}", default: education.degree),
                                    field: t("education_fields.#{education.field_of_study}", default: education.field_of_study)) %>
                                <% if education.institution.present? %>
                                    <%= t('psychologist_profiles.show.at_institution', institution: education.institution) %>
                                <% end %>
                            </h3>
                            <p>
                                <% if education.graduation_year.present? %>
                                    <%= t('psychologist_profiles.show.graduated_in', year: education.graduation_year) %>
                                <% else %>
                                    <%= t('psychologist_profiles.show.professional_qualification') %>
                                <% end %>
                            </p>
                        </div>
                    </div>
                <% end %>
            </div>
        </div>
        <% end %>

        <div class="content-card">
             <h2 class="section-title"><i class="fas fa-address-book"></i> Contact Information</h2>
            <%# ---- Main CTA Buttons ---- %>
            <div class="button-group">
                <% if contact_link %>
                    <a href="<%= contact_link %>" class="button is-secondary">
                        <i class="<%= contact_keys[primary_contact_method.to_sym] %> mr-2"></i>
                        <span><%= t('psychologist_profiles.show.contact_me') %></span>
                    </a>
                <% end %>
            </div>             <button class="toggle-button toggle-contacts" aria-expanded="false" data-show-text="<%= t('psychologist_profiles.show.show_all_contacts') %>" data-hide-text="<%= t('psychologist_profiles.show.hide_all_contacts') %>">
                <span class="toggle-text"><%= t('psychologist_profiles.show.show_all_contacts') %></span> <i class="fas fa-chevron-down"></i>
            </button>
            <div class="collapsible-content contact-list">
                <% other_methods = contact_keys.reject { |k, _| k.to_s == primary_contact_method } %>
                <% other_methods.each do |method, icon| %>
                  <% value = case method
                              when :email then @psychologist_profile.user.email
                              when :telegram then @psychologist_profile.telegram
                              when :whatsapp then @psychologist_profile.whatsapp
                              when :primary_phone then @psychologist_profile.contact_phone
                              else nil
                              end %>
                  <% link = case method
                             when :email then "mailto:#{value}"
                             when :telegram then "https://t.me/#{value}"
                             when :whatsapp then "https://wa.me/#{value}"
                             when :primary_phone then "tel:#{value}"
                             else nil
                             end %>
                  <% if value.present? %>
                      <div class="contact-item" data-method="<%= method %>">
                          <div class="contact-info">
                              <i class="<%= icon %>"></i>
                              <span><%= method.to_s.capitalize %></span>
                          </div>
                          <div class="contact-actions">
                              <input class="contact-input" readonly value="<%= value %>">
                              <button class="copy-button" data-value="<%= value %>" title="<%= t('psychologist_profiles.show.copy') %>">
                                  <i class="fas fa-copy"></i>
                              </button>
                              <a href="<%= link %>" class="contact-link" target="_blank" title="<%= t('psychologist_profiles.show.open_link') %>">
                                  <i class="fas fa-external-link-alt"></i>
                              </a>
                          </div>
                      </div>
                  <% end %>
                <% end %>
            </div>
        </div>

    </main>
</div>
</div>

<script>
    // This script is for reference and should be included in your application's asset pipeline.
// The HTML and CSS will work with your existing script, but this is a vanilla JS implementation for reference.

document.addEventListener('DOMContentLoaded', () => {

  // --- TOGGLE FUNCTIONALITY FOR VIDEO AND CONTACTS ---
  const setupToggleButton = (buttonSelector, contentSelector) => {
    const toggleButton = document.querySelector(buttonSelector);
    const content = document.querySelector(contentSelector);

    if (toggleButton && content) {
      toggleButton.addEventListener('click', () => {
        const isExpanded = toggleButton.getAttribute('aria-expanded') === 'true';
        toggleButton.setAttribute('aria-expanded', !isExpanded);
        
        const toggleText = toggleButton.querySelector('.toggle-text');
        const showText = toggleButton.dataset.showText;
        const hideText = toggleButton.dataset.hideText;

        if (!isExpanded) {
          // Open
          content.style.display = 'flex'; // Use flex for consistency with CSS
          if (toggleText) toggleText.textContent = hideText;
        } else {
          // Close
          content.style.display = 'none';
          if (toggleText) toggleText.textContent = showText;
        }
      });
    }
  };

  setupToggleButton('.toggle-video', '.video-content');
  setupToggleButton('.toggle-contacts', '.contact-list');


  // --- COPY BUTTON FUNCTIONALITY ---
  const copyButtons = document.querySelectorAll('.copy-button');
  copyButtons.forEach(button => {
    button.addEventListener('click', () => {
      const valueToCopy = button.dataset.value;
      const icon = button.querySelector('i');
      
      if (valueToCopy) {
        // Use a temporary textarea to copy
        const tempTextArea = document.createElement('textarea');
        tempTextArea.value = valueToCopy;
        document.body.appendChild(tempTextArea);
        tempTextArea.select();
        document.execCommand('copy');
        document.body.removeChild(tempTextArea);

        // Visual feedback
        if (icon) {
          const originalIcon = icon.className;
          icon.className = 'fas fa-check';
          button.style.color = 'var(--success)';
          
          setTimeout(() => {
            icon.className = originalIcon;
            button.style.color = ''; // Revert to original color
          }, 1500);
        }
      }
    });
  });

});

</script>